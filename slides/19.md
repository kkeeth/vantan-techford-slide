---
theme: default
background: https://picsum.photos/1920/1080
class: text-center
highlighter: shiki
lineNumbers: false
info: |
  ## TypeScript + React ãƒãƒ³ã‚ºã‚ªãƒ³è¬›åº§
  ç¬¬19å›ï¼šãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªé–‹ç™ºï¼ˆé«˜åº¦ãªæ©Ÿèƒ½è¿½åŠ ç·¨ï¼‰
fonts:
  sans: "Josefin Sans"
  serif: "Noto Sans JP"
  mono: "Fira Code"

drawings:
  persist: false
transition: slide-left
title: TypeScript/React å…¥é–€è¬›ç¾©
---

# TypeScript + React<br>ãƒãƒ³ã‚ºã‚ªãƒ³è¬›åº§

## ç¬¬19å›ï¼šãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªé–‹ç™º<br>é«˜åº¦ãªæ©Ÿèƒ½è¿½åŠ ç·¨

<div class="pt-12">
  <span @click="$slidev.nav.next" class="px-2 py-1 rounded cursor-pointer" hover="bg-white bg-opacity-10">
    Press Space for next page <carbon:arrow-right class="inline"/>
  </span>
</div>

<div class="abs-br m-6 flex gap-2">
  <button @click="$slidev.nav.openInEditor()" title="Open in Editor" class="text-xl slidev-icon-btn opacity-50 !border-none !hover:text-white">
    <carbon:edit />
  </button>
</div>

<style>
  h1 {
    color: #fff;
  }
</style>

---
layout: section
---

# å‡ºå¸­ç¢ºèªâœ‹ï¸

---
layout: default
---

# æœ¬æ—¥ã®å†…å®¹

<Toc minDepth="2" maxDepth="2" />

<style>
h2 {
  margin: 1rem 0;
}
</style>

## ğŸ‘‰ï¸ ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã‚’ã•ã‚‰ã«ä¾¿åˆ©ã«ã—ã‚ˆã†ï¼

---
layout: section
---

# ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã®é«˜åº¦ãªæ©Ÿèƒ½è¿½åŠ 

---

# ç›®æ¬¡

## 1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
## 2. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç·¨é›†æ©Ÿèƒ½
## 3. æ¤œç´¢æ©Ÿèƒ½ã®è¿½åŠ 
## 4. ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šæ©Ÿèƒ½
## 5. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

â€»ä»Šå›ã¯ TypeScript ã§ã‚ˆã‚Šå®Ÿç”¨çš„ãªãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã™ï¼

<style>
h2 {
  margin-bottom: .5rem;
}
</style>

---

# 1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

## 1.1 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²ã®å¿…è¦æ€§

ç¾åœ¨ã® App.tsx ã¯å…¨ã¦ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒè©°ã¾ã£ã¦ã„ã¾ã™ï¼š

ğŸ“ **ç¾çŠ¶ã®èª²é¡Œï¼š**
- App.tsx ãŒé•·ããªã‚Šã™ãã¦ã„ã‚‹ï¼ˆ400è¡Œä»¥ä¸Šï¼‰
- UIãƒ»ãƒ­ã‚¸ãƒƒã‚¯ãƒ»ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãŒæ··åœ¨
- å†åˆ©ç”¨æ€§ãŒä½ã„
- ãƒ†ã‚¹ãƒˆãŒã—ã«ãã„
- ã‚³ãƒ¼ãƒ‰ã®è¦‹é€šã—ãŒæ‚ªã„

ğŸ“ **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®æ–¹é‡ï¼š**
1. **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²**: MessageItem, MessageForm, ImageUploader ãªã©
2. **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯åŒ–**: useImageUpload, useColors ãªã©
3. **ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£åˆ†é›¢**: dateFormatter, fileValidator ãªã©
4. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å±¤ã®åˆ†é›¢**: db.ts ã‚’ services/ ã«ç§»å‹•

---

## 1.2 ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®å…¨ä½“åƒ

ä»Šå›ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã§ä½œæˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆï¼š

<div grid="~ cols-2 gap-4">
<div>

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ MessageItem.tsx
â”‚   â”œâ”€â”€ MessageForm.tsx
â”‚   â””â”€â”€ ImageUploader.tsx
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useImageUpload.ts
â”‚   â””â”€â”€ useColors.ts
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ dateFormatter.ts
â”‚   â””â”€â”€ fileValidator.ts
```

</div>
<div>

ğŸ“ **åˆ†å‰²ã®å„ªå…ˆé †ä½ï¼š**

1. **MessageItem** - æœ€ã‚‚é‡è¦
2. **MessageForm** - å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 
3. **ImageUploader** - ç”»åƒæ©Ÿèƒ½
4. **ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯** - ãƒ­ã‚¸ãƒƒã‚¯æŠ½å‡º
5. **ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£** - å…±é€šé–¢æ•°

â€»ä»Šå›ã¯ä¸»è¦ãª3ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨<br>2ã¤ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™

</div>
</div>

---

## 1.3 ç¾åœ¨ã® App.tsx ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºéƒ¨åˆ†

ã¾ãšã€ç¾åœ¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºéƒ¨åˆ†ã‚’ç¢ºèªã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// App.tsx ã®ä¸€éƒ¨ï¼ˆç¾çŠ¶ï¼‰
{messages.map((message) => (
  <Card
    key={message.id}
    sx={{
      mb: 2,
      bgcolor: 'rgba(255, 255, 255, 0.9)',
      backdropFilter: 'blur(10px)',
      boxShadow: 2,
      borderRadius: 2,
      transition: 'all 0.3s ease',
      '&:hover': {
        boxShadow: 4,
        transform: 'translateY(-2px)',
      },
    }}
  >
    <CardContent>
      <Typography variant="body1" sx={{ mb: 1 }}>
        {message.text}
      </Typography>
      {message.image && (
        <Box sx={{ mt: 2, mb: 1 }}>
          <img
            src={message.image}
            alt={message.imageName}
            style={{
              maxWidth: '100%',
              maxHeight: '300px',
              borderRadius: '8px',
            }}
          />
        </Box>
      )}
```

</div>
<div>

```tsx
      <Typography
        variant="caption"
        sx={{
          color: 'text.secondary',
          display: 'block',
          mt: 1,
        }}
      >
        {message.date}
      </Typography>
    </CardContent>
    <CardActions sx={{ justifyContent: 'flex-end' }}>
      <Button
        size="small"
        color="error"
        startIcon={<DeleteIcon />}
        onClick={() => deleteMessage(message.id!)}
        sx={{
          borderRadius: 2,
          fontSize: { xs: '0.8rem', sm: '0.875rem' },
          '&:hover': {
            backgroundColor: 'rgba(244, 67, 54, 0.08)',
          },
        }}
      >
        å‰Šé™¤
      </Button>
    </CardActions>
  </Card>
))}
```

ğŸ“ **ã“ã®éƒ¨åˆ†ã‚’ MessageItem ã«åˆ†å‰²ã—ã¾ã™**

</div>
</div>

---

## 1.4 MessageItem ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆ

æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºéƒ¨åˆ†ã‚’åˆ‡ã‚Šå‡ºã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/components/MessageItem.tsx
import { Card, CardContent, CardActions, Typography, Button, Box } from '@mui/material';
import DeleteIcon from '@mui/icons-material/Delete';
import type { Message } from '../db';

type MessageItemProps = {
  message: Message;
  onDelete: (id: string) => void;
};

export const MessageItem = ({ message, onDelete }: MessageItemProps) => {
  const handleDelete = () => {
    if (message.id) {
      onDelete(message.id);
    }
  };

  return (
    <Card
      sx={{
        mb: 2,
        bgcolor: 'rgba(255, 255, 255, 0.9)',
        backdropFilter: 'blur(10px)',
        boxShadow: 2,
        borderRadius: 2,
        transition: 'all 0.3s ease',
        '&:hover': {
          boxShadow: 4,
          transform: 'translateY(-2px)',
        },
      }}
    >
```

</div>
<div>

```tsx
      <CardContent>
        <Typography variant="body1" sx={{ mb: 1 }}>
          {message.text}
        </Typography>
        {message.image && (
          <Box sx={{ mt: 2, mb: 1 }}>
            <img
              src={message.image}
              alt={message.imageName}
              style={{
                maxWidth: '100%',
                maxHeight: '300px',
                borderRadius: '8px',
              }}
            />
          </Box>
        )}
        <Typography
          variant="caption"
          sx={{
            color: 'text.secondary',
            display: 'block',
            mt: 1,
          }}
        >
          {message.date}
        </Typography>
      </CardContent>
      <CardActions sx={{ justifyContent: 'flex-end' }}>
        <Button
          size="small"
          color="error"
          startIcon={<DeleteIcon />}
          onClick={handleDelete}
          sx={{
            borderRadius: 2,
            fontSize: { xs: '0.8rem', sm: '0.875rem' },
            '&:hover': {
              backgroundColor: 'rgba(244, 67, 54, 0.08)',
            },
          }}
        >
          å‰Šé™¤
        </Button>
      </CardActions>
    </Card>
  );
};
```

</div>
</div>

---

## 1.5 App.tsx ã§ MessageItem ã‚’ä½¿ç”¨

App.tsx ã§ã“ã®æ–°ã—ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```diff
// App.tsx
+import { MessageItem } from './components/MessageItem';

  return (
    <Box
      sx={{
        minHeight: '100vh',
        display: 'flex',
        flexDirection: 'column',
        background: colors.background,
      }}
    >
      <Container maxWidth="md" sx={{ flex: 1, py: 4 }}>
        {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
        <Typography
          variant="h4"
          component="h1"
          sx={{
            fontWeight: 'bold',
            color: colors.primary,
            textAlign: 'center',
            mb: 4,
          }}
        >
          ğŸ’¬ ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒª
        </Typography>
```

</div>
<div>

```diff
        {/* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§ */}
        <Box sx={{ mb: 4 }}>
-         {messages.map((message) => (
-           <Card key={message.id} sx={{ ... }}>
-             <CardContent>...</CardContent>
-             <CardActions>...</CardActions>
-           </Card>
-         ))}
+         {messages.map((message) => (
+           <MessageItem
+             key={message.id}
+             message={message}
+             onDelete={deleteMessage}
+           />
+         ))}
        </Box>

        {/* å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  */}
        <Box sx={{ ... }}>
          {/* ... */}
        </Box>
      </Container>
    </Box>
  );
};
```

ğŸ“ **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ãƒ¡ãƒªãƒƒãƒˆï¼š**

- App.tsx ãŒã‚·ãƒ³ãƒ—ãƒ«ã«ãªã£ãŸ
- MessageItem ã®å†åˆ©ç”¨ãŒå¯èƒ½ã«
- è²¬ä»»ãŒæ˜ç¢ºã«åˆ†é›¢ã•ã‚ŒãŸ

</div>
</div>

---

## 1.6 MessageForm ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆ

å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ éƒ¨åˆ†ã‚‚åˆ‡ã‚Šå‡ºã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/components/MessageForm.tsx
import { FormEvent, ChangeEvent } from 'react';
import {
  Paper,
  Stack,
  TextField,
  Fab,
  Typography,
} from '@mui/material';
import SendIcon from '@mui/icons-material/Send';

type MessageFormProps = {
  text: string;
  isPosting: boolean;
  onTextChange: (e: ChangeEvent<HTMLInputElement>) => void;
  onSubmit: (e: FormEvent<HTMLFormElement>) => void;
  disabled: boolean;
};

export const MessageForm = ({
  text,
  isPosting,
  onTextChange,
  onSubmit,
  disabled,
}: MessageFormProps) => {
  return (
    <Paper
      elevation={3}
      sx={{
        p: { xs: 2, sm: 3 },
        mb: 4,
        borderRadius: { xs: 0, sm: 4 },
      }}
    >
```

</div>
<div>

```tsx
      <form onSubmit={onSubmit}>
        <Stack spacing={2}>
          <Typography variant="h6" sx={{ fontWeight: 'medium' }}>
            ä»Šã®æ°—åˆ†ã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ
          </Typography>
          <TextField
            fullWidth
            multiline
            minRows={3}
            placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..."
            value={text}
            onChange={onTextChange}
            disabled={isPosting}
          />
          <Fab
            type="submit"
            color="primary"
            disabled={disabled}
            sx={{ alignSelf: 'flex-end' }}
          >
            <SendIcon />
          </Fab>
        </Stack>
      </form>
    </Paper>
  );
};
```

ğŸ“ **åˆ†å‰²ã®ãƒ¡ãƒªãƒƒãƒˆï¼š**

- ãƒ•ã‚©ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ãŒç‹¬ç«‹
- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ props ã§åˆ¶å¾¡

</div>
</div>

---

## 1.7 ImageUploader ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆ

ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚‚åˆ‡ã‚Šå‡ºã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/components/ImageUploader.tsx
import { ChangeEvent, useRef } from 'react';
import { Button, Paper, Box, IconButton, Typography } from '@mui/material';
import AddPhotoAlternateIcon from '@mui/icons-material/AddPhotoAlternate';
import CloseIcon from '@mui/icons-material/Close';

type ImageUploaderProps = {
  image: File | null;
  onImageSelect: (e: ChangeEvent<HTMLInputElement>) => void;
  onImageRemove: () => void;
};

export const ImageUploader = ({
  image,
  onImageSelect,
  onImageRemove,
}: ImageUploaderProps) => {
  const fileInputRef = useRef<HTMLInputElement>(null);

  return (
    <>
      <input
        ref={fileInputRef}
        type="file"
        accept="image/*"
        style={{ display: 'none' }}
        onChange={onImageSelect}
      />
```

</div>
<div>

```tsx
      <Button
        startIcon={<AddPhotoAlternateIcon />}
        onClick={() => fileInputRef.current?.click()}
        sx={{ mb: 2 }}
      >
        ç”»åƒã‚’è¿½åŠ 
      </Button>

      {image && (
        <Paper sx={{ p: 2, mb: 2 }}>
          <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 1 }}>
            <Typography variant="body2">{image.name}</Typography>
            <IconButton size="small" onClick={onImageRemove}>
              <CloseIcon />
            </IconButton>
          </Box>
          <img
            src={URL.createObjectURL(image)}
            alt="preview"
            style={{ maxWidth: '100%', borderRadius: '8px' }}
          />
        </Paper>
      )}
    </>
  );
};
```

</div>
</div>

---

## 1.8 ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ï¼šuseImageUpload ã®ä½œæˆ

ç”»åƒç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ•ãƒƒã‚¯åŒ–ã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/hooks/useImageUpload.ts
import { useState, useCallback, ChangeEvent } from 'react';
import { validateFile } from '../utils/fileValidator';

type UseImageUploadReturn = {
  image: File | null;
  setImage: (file: File | null) => void;
  handleSelectImage: (e: ChangeEvent<HTMLInputElement>) => void;
  readImageAsDataURL: (file: File) => Promise<string>;
};

export const useImageUpload = (): UseImageUploadReturn => {
  const [image, setImage] = useState<File | null>(null);

  const handleSelectImage = useCallback(
    (e: ChangeEvent<HTMLInputElement>): void => {
      const file = e.target.files?.[0];
      if (!file) return;

      const error = validateFile(file);
      if (error) {
        alert(error);
        e.target.value = '';
        return;
      }
      setImage(file);
    },
    []
  );
```

</div>
<div>

```tsx
  const readImageAsDataURL = useCallback(
    (file: File): Promise<string> => {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result as string);
        reader.onerror = () => reject(reader.error);
        reader.readAsDataURL(file);
      });
    },
    []
  );

  return {
    image,
    setImage,
    handleSelectImage,
    readImageAsDataURL,
  };
};
```

ğŸ“ **ãƒ•ãƒƒã‚¯ã®ãƒ¡ãƒªãƒƒãƒˆï¼š**

- ç”»åƒç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯ã®å†åˆ©ç”¨
- ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚·ãƒ³ãƒ—ãƒ«ã«

</div>
</div>

---

## 1.9 ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ï¼šuseColors ã®ä½œæˆ

ãƒ†ãƒ¼ãƒè‰²ã®å–å¾—ã‚‚ãƒ•ãƒƒã‚¯åŒ–ã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/hooks/useColors.ts
import { useTheme } from '@mui/material/styles';

type Colors = {
  primary: string;
  secondary: string;
  surface: string;
  gradient: string;
  background: string;
};

export const useColors = (): Colors => {
  const theme = useTheme();

  return {
    primary: theme.palette.primary.main,
    secondary: theme.palette.secondary.main,
    surface: theme.palette.background.paper,
    gradient: `linear-gradient(135deg, ${theme.palette.primary.main} 0%, ${theme.palette.secondary.main} 100%)`,
    background: theme.palette.background.default,
  };
};
```

</div>
<div>

```tsx
// App.tsx ã§ã®ä½¿ç”¨
import { useColors } from './hooks/useColors';

const App = () => {
  const colors = useColors();

  return (
    <Box sx={{ background: colors.gradient }}>
      {/* ... */}
    </Box>
  );
};
```

ğŸ“ **useColors ã®ãƒ¡ãƒªãƒƒãƒˆï¼š**

- ãƒ†ãƒ¼ãƒè‰²ã®å–å¾—ã‚’ä¸€å…ƒåŒ–
- å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§å†åˆ©ç”¨å¯èƒ½
- ã‚«ãƒ©ãƒ¼ãƒ­ã‚¸ãƒƒã‚¯ã®å¤‰æ›´ãŒå®¹æ˜“

</div>
</div>

---

## 1.10 ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã®åˆ†é›¢

å…±é€šé–¢æ•°ã‚‚åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«ç§»å‹•ã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/utils/fileValidator.ts
export const FILE_LIMITS = {
  MAX_SIZE: 5 * 1024 * 1024, // 5MB
  MAX_FILENAME_LENGTH: 100,
  ALLOWED_TYPES: [
    'image/jpeg',
    'image/jpg',
    'image/png',
    'image/gif',
  ],
};

export const validateFile = (file: File): string => {
  if (!FILE_LIMITS.ALLOWED_TYPES.includes(file.type)) {
    return 'JPEG, PNG, GIF ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯èƒ½ã§ã™';
  }
  if (file.size > FILE_LIMITS.MAX_SIZE) {
    return 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã™ãã¾ã™ï¼ˆæœ€å¤§5MBï¼‰';
  }
  if (file.name.length > FILE_LIMITS.MAX_FILENAME_LENGTH) {
    return 'ãƒ•ã‚¡ã‚¤ãƒ«åãŒé•·ã™ãã¾ã™';
  }
  return '';
};
```

</div>
<div>

```tsx
// src/utils/dateFormatter.ts
export const formatRelativeTime = (date: string): string => {
  const now = new Date();
  const messageDate = new Date(date);
  const diffMs = now.getTime() - messageDate.getTime();
  const diffMins = Math.floor(diffMs / 60000);

  if (diffMins < 1) return 'ãŸã£ãŸä»Š';
  if (diffMins < 60) return `${diffMins}åˆ†å‰`;

  const diffHours = Math.floor(diffMins / 60);
  if (diffHours < 24) return `${diffHours}æ™‚é–“å‰`;

  const diffDays = Math.floor(diffHours / 24);
  if (diffDays < 7) return `${diffDays}æ—¥å‰`;

  return messageDate.toLocaleDateString('ja-JP');
};
```

ğŸ“ **ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®ãƒ¡ãƒªãƒƒãƒˆï¼š**

- å…±é€šãƒ­ã‚¸ãƒƒã‚¯ã®ä¸€å…ƒç®¡ç†
- å˜ä½“ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“
- å®šæ•°ç®¡ç†ãŒæ˜ç¢º

</div>
</div>

---

## 1.11 ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œã® App.tsx

å…¨ã¦ã‚’çµ±åˆã—ãŸ App.tsx ã¯ã“ã®ã‚ˆã†ã«ã‚·ãƒ³ãƒ—ãƒ«ã«ãªã‚Šã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// App.tsx
import { useState, useCallback, FormEvent } from 'react';
import { Container, Box } from '@mui/material';
import { v4 as uuidv4 } from 'uuid';
import { MessageItem } from './components/MessageItem';
import { MessageForm } from './components/MessageForm';
import { ImageUploader } from './components/ImageUploader';
import { useColors } from './hooks/useColors';
import { useImageUpload } from './hooks/useImageUpload';
import { db } from './db';
import type { Message } from './db';

const App = () => {
  const colors = useColors();
  const [text, setText] = useState<string>('');
  const [messages, setMessages] = useState<Message[]>([]);
  const [isPosting, setIsPosting] = useState<boolean>(false);
  const { image, setImage, handleSelectImage, readImageAsDataURL } =
    useImageUpload();

  const handlePost = useCallback(
    async (e: FormEvent<HTMLFormElement>): Promise<void> => {
      e.preventDefault();
      if (!text.trim() || isPosting) return;

      setIsPosting(true);
      try {
        const imageData = image
          ? await readImageAsDataURL(image)
          : undefined;
```

</div>
<div>

```tsx
        const newMessage: Message = {
          id: uuidv4(),
          text: text.trim(),
          image: imageData,
          imageName: image?.name,
          date: new Date().toLocaleString('ja-JP'),
          createdAt: new Date(),
        };

        await db.messages.add(newMessage);
        setMessages((prev) => [newMessage, ...prev]);
        setText('');
        setImage(null);
      } catch (error) {
        console.error(error);
        alert('æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
      } finally {
        setIsPosting(false);
      }
    },
    [text, image, isPosting, readImageAsDataURL]
  );

  return (
    <Box sx={{ minHeight: '100vh', background: colors.gradient }}>
      <Container maxWidth="md" sx={{ py: 4 }}>
        <MessageForm
          text={text}
          isPosting={isPosting}
          onTextChange={(e) => setText(e.target.value)}
          onSubmit={handlePost}
          disabled={!text.trim() || isPosting}
        />
        <ImageUploader
          image={image}
          onImageSelect={handleSelectImage}
          onImageRemove={() => setImage(null)}
        />
        {messages.map((message) => (
          <MessageItem key={message.id} message={message} onDelete={deleteMessage} />
        ))}
      </Container>
    </Box>
  );
};
```

</div>
</div>

---

## 1.12 ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®åŠ¹æœç¢ºèª

ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å‰å¾Œã‚’æ¯”è¼ƒã—ã¾ã—ã‚‡ã†ï¼š

<v-clicks>

âœ… **ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§å‘ä¸Šï¼š**
- App.tsx ãŒ400è¡Œã‹ã‚‰150è¡Œã«å‰Šæ¸›ï¼ˆç´„60%å‰Šæ¸›ï¼‰
- å„ãƒ•ã‚¡ã‚¤ãƒ«ã®è²¬ä»»ãŒæ˜ç¢º

âœ… **ä¿å®ˆæ€§ã®å‘ä¸Šï¼š**
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå˜ä½ã§ä¿®æ­£å¯èƒ½
- ãƒ†ã‚¹ãƒˆãŒæ›¸ãã‚„ã™ããªã£ãŸ

âœ… **å†åˆ©ç”¨æ€§ã®å‘ä¸Šï¼š**
- MessageItem, MessageForm ãªã©ã‚’ä»–ã®ç”»é¢ã§ã‚‚ä½¿ãˆã‚‹
- ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã§å…±é€šãƒ­ã‚¸ãƒƒã‚¯ã‚’å…±æœ‰

âœ… **å‹å®‰å…¨æ€§ã®ç¢ºä¿ï¼š**
- Props ã§å‹ã‚’æ˜ç¤º
- TypeScript ã®æ©æµã‚’æœ€å¤§é™ã«æ´»ç”¨

âœ… **ãƒãƒ¼ãƒ é–‹ç™ºã¸ã®å¯¾å¿œï¼š**
- ãƒ•ã‚¡ã‚¤ãƒ«å˜ä½ã§ä½œæ¥­åˆ†æ‹…ãŒå¯èƒ½
- ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆãŒèµ·ãã«ãã„æ§‹é€ 

</v-clicks>

---

# 2. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç·¨é›†æ©Ÿèƒ½

## 2.1 ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç·¨é›†æ©Ÿèƒ½ã®å¿…è¦æ€§

å‰Šé™¤ã ã‘ã§ãªãï¼Œç·¨é›†æ©Ÿèƒ½ã‚‚è¿½åŠ ã—ã¾ã—ã‚‡ã†ï¼š

ğŸ“ **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‹ãƒ¼ã‚ºï¼š**
- ã‚¿ã‚¤ãƒã®ä¿®æ­£
- è¿½åŠ æƒ…å ±ã®è¨˜å…¥
- èª¤ã£ãŸæƒ…å ±ã®è¨‚æ­£

ğŸ“ **æŠ€è¡“çš„ãªæ¤œè¨ç‚¹ï¼š**
- ç·¨é›†ä¸­ã®çŠ¶æ…‹ç®¡ç†
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ›´æ–°å‡¦ç†
- ç·¨é›†å±¥æ­´ã®ä¿æŒï¼ˆä»Šå›ã¯çœç•¥ï¼‰

---

## 2.2 ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç·¨é›†æ©Ÿèƒ½ã®å®Ÿè£…

MessageItem ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ç·¨é›†æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```diff
// src/components/MessageItem.tsx
+import { useState } from 'react';
+import { IconButton, TextField } from '@mui/material';
+import EditIcon from '@mui/icons-material/Edit';
+import CheckIcon from '@mui/icons-material/Check';
+import CancelIcon from '@mui/icons-material/Cancel';

  type MessageItemProps = {
    message: Message;
-   onDelete: (id: string) => void;
+   onDelete: (id: string) => void;
+   onEdit: (id: string, newText: string) => void;
  };

  export const MessageItem = ({
-   message, onDelete
+   message, onDelete, onEdit
  }: MessageItemProps) => {
+   const [isEditing, setIsEditing] = useState(false);
+   const [editText, setEditText] = useState(message.text);
+
+   const handleEdit = () => {
+     setIsEditing(true);
+     setEditText(message.text);
+   };
+
+   const handleSave = () => {
+     if (editText.trim() && message.id) {
+       onEdit(message.id, editText.trim());
+       setIsEditing(false);
+     }
+   };
+
+   const handleCancel = () => {
+     setEditText(message.text);
+     setIsEditing(false);
+   };
```

</div>
<div>

```tsx
  const handleDelete = () => {
    if (message.id) {
      onDelete(message.id);
    }
  };

  return (
    <Card
      sx={{
        mb: 2,
        bgcolor: 'rgba(255, 255, 255, 0.9)',
        backdropFilter: 'blur(10px)',
        boxShadow: 2,
        borderRadius: 2,
        position: 'relative',
        '&:hover .action-buttons': {
          visibility: 'visible',
        },
      }}
    >
      {/* ç·¨é›†ãƒ»å‰Šé™¤ãƒœã‚¿ãƒ³ */}
      {!isEditing && (
        <Box
          className="action-buttons"
          sx={{
            position: 'absolute',
            top: 8,
            right: 8,
            visibility: 'hidden',
            display: 'flex',
            gap: 1,
            zIndex: 1,
          }}
        >
          <IconButton onClick={handleEdit} size="small">
            <EditIcon fontSize="small" />
          </IconButton>
          <IconButton onClick={handleDelete} size="small">
            <DeleteIcon fontSize="small" />
          </IconButton>
        </Box>
      )}
```

</div>
</div>

---

## 2.3 ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã® UI å®Ÿè£…

ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã§ã¯ TextField ã¨ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/components/MessageItem.tsxï¼ˆç¶šãï¼‰
      <CardContent>
        {/* ç·¨é›†ä¸­ã®ä¿å­˜ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³ */}
        {isEditing && (
          <Box sx={{ display: 'flex', gap: 1, mb: 1 }}>
            <IconButton onClick={handleSave} size="small" color="primary">
              <CheckIcon />
            </IconButton>
            <IconButton onClick={handleCancel} size="small">
              <CancelIcon />
            </IconButton>
          </Box>
        )}

        {/* ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤ºã¾ãŸã¯ç·¨é›†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ */}
        {isEditing ? (
          <TextField
            fullWidth
            multiline
            minRows={2}
            value={editText}
            onChange={(e) => setEditText(e.target.value)}
            autoFocus
            sx={{ mb: 1 }}
          />
        ) : (
          <Typography variant="body1" sx={{ mb: 1 }}>
            {message.text}
          </Typography>
        )}
```

</div>
<div>

```tsx
        {message.image && (
          <Box sx={{ mt: 2, mb: 1 }}>
            <img
              src={message.image}
              alt={message.imageName}
              style={{
                maxWidth: '100%',
                maxHeight: '300px',
                borderRadius: '8px',
              }}
            />
          </Box>
        )}

        <Typography
          variant="caption"
          sx={{
            color: 'text.secondary',
            display: 'block',
            mt: 1,
          }}
        >
          {message.date}
        </Typography>
      </CardContent>
    </Card>
  );
};
```

ğŸ“ **ç·¨é›† UI ã®ãƒã‚¤ãƒ³ãƒˆï¼š**

- ãƒ›ãƒãƒ¼æ™‚ã«ç·¨é›†ãƒ»å‰Šé™¤ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
- ç·¨é›†ä¸­ã¯ TextField ã§å…¥åŠ›
- ä¿å­˜ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³ã§æ“ä½œ

</div>
</div>

---

## 2.4 App.tsx ã§ã®ç·¨é›†æ©Ÿèƒ½çµ±åˆ

App.tsx ã«ç·¨é›†å‡¦ç†ã‚’è¿½åŠ ã—ã€MessageItem ã«æ¸¡ã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```diff
// App.tsx
  const deleteMessage = useCallback(
    async (id: string): Promise<void> => {
      // ... å‰Šé™¤å‡¦ç† ...
    },
    [messages]
  );

+ const editMessage = useCallback(
+   async (id: string, newText: string): Promise<void> => {
+     if (!newText.trim()) {
+       alert('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
+       return;
+     }
+
+     try {
+       const updatedAt = new Date();
+
+       await db.messages.update(id, {
+         text: newText,
+         updatedAt
+       });
+
+       setMessages(prev => prev.map(msg =>
+         msg.id === id
+           ? { ...msg, text: newText, updatedAt }
+           : msg
+       ));
+     } catch (error) {
+       console.error('ç·¨é›†ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
+       alert('ç·¨é›†ã«å¤±æ•—ã—ã¾ã—ãŸ');
+     }
+   },
+   []
+ );
```

</div>
<div>

```diff
// Message å‹ã®æ›´æ–°
  export type Message = {
    id?: string;
    text: string;
    image?: string;
+   imageName?: string;
    date: string;
    createdAt: Date;
+   updatedAt?: Date;
  };

  // MessageItem ã§ã®ä½¿ç”¨
  {messages.map((message) => (
    <MessageItem
      key={message.id}
      message={message}
      onDelete={deleteMessage}
+     onEdit={editMessage}
    />
  ))}
```

ğŸ“ **å‹å®‰å…¨æ€§ï¼š**

- `updatedAt` ã¯ optional ã¨ã—ã¦å®šç¾©
- `useCallback` ã§ãƒ¡ãƒ¢åŒ–ã—ã¦å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’é˜²æ­¢

</div>
</div>

---

## 2.5 ç·¨é›†æ¸ˆã¿ãƒãƒ¼ã‚¯ã®è¡¨ç¤º

ç·¨é›†ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã€Œç·¨é›†æ¸ˆã¿ã€ãƒãƒ¼ã‚¯ã‚’è¿½åŠ ã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```diff
// src/components/MessageItem.tsx
  <Typography
    variant="caption"
    sx={{
      color: 'text.secondary',
      display: 'block',
      mt: 1,
    }}
  >
    {message.date}
+   {message.updatedAt && ' (ç·¨é›†æ¸ˆã¿)'}
  </Typography>
```

</div>
<div>

ã‚ˆã‚Šç›®ç«‹ãŸã›ãŸã„å ´åˆï¼š

```tsx
<Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
  <Typography
    variant="caption"
    sx={{ color: 'text.secondary' }}
  >
    {message.date}
  </Typography>
  {message.updatedAt && (
    <Typography
      variant="caption"
      sx={{
        color: 'text.secondary',
        fontSize: '0.7rem',
        fontStyle: 'italic',
        backgroundColor: 'rgba(0, 0, 0, 0.05)',
        px: 1,
        py: 0.5,
        borderRadius: 1,
      }}
    >
      ç·¨é›†æ¸ˆã¿
    </Typography>
  )}
</Box>
```

</div>
</div>

---

# 3. æ¤œç´¢æ©Ÿèƒ½ã®è¿½åŠ 

## 3.1 æ¤œç´¢æ©Ÿèƒ½ã®å¿…è¦æ€§

ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå¢—ãˆã¦ãã‚‹ã¨æ¤œç´¢æ©Ÿèƒ½ãŒå¿…è¦ã«ãªã‚Šã¾ã™ï¼š

ğŸ“ **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‹ãƒ¼ã‚ºï¼š**
- éå»ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç´ æ—©ãè¦‹ã¤ã‘ãŸã„
- ç‰¹å®šã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§çµã‚Šè¾¼ã¿ãŸã„
- æ—¥ä»˜ã§çµã‚Šè¾¼ã¿ãŸã„

ğŸ“ **å®Ÿè£…æ–¹é‡ï¼š**
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œç´¢
- å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„
- æ¤œç´¢çµæœã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ

---

## 3.2 æ¤œç´¢ UI ã®å®Ÿè£…

æ¤œç´¢æ©Ÿèƒ½ã® UI ã‚’è¿½åŠ ã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/components/SearchBar.tsx
import { TextField, InputAdornment } from '@mui/material';
import SearchIcon from '@mui/icons-material/Search';
import ClearIcon from '@mui/icons-material/Clear';

type SearchBarProps = {
  searchTerm: string;
  onSearchChange: (term: string) => void;
};

export const SearchBar = ({ searchTerm, onSearchChange }: SearchBarProps) => {
  const handleClear = () => {
    onSearchChange('');
  };

  return (
    <TextField
      fullWidth
      placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¤œç´¢..."
      value={searchTerm}
      onChange={(e) => onSearchChange(e.target.value)}
      size="small"
      sx={{ mb: 2 }}
```

</div>
<div>

```tsx
      InputProps={{
        startAdornment: (
          <InputAdornment position="start">
            <SearchIcon />
          </InputAdornment>
        ),
        endAdornment: searchTerm && (
          <InputAdornment position="end">
            <IconButton onClick={handleClear} size="small">
              <ClearIcon />
            </IconButton>
          </InputAdornment>
        ),
      }}
    />
  );
};
```

</div>
</div>

<div grid="~ cols-2 gap-4">
<div>

```tsx
// App.tsx ã§ã®çŠ¶æ…‹ç®¡ç†
const [searchTerm, setSearchTerm] = useState('');

// æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é–¢æ•°
const filteredMessages = useMemo(() => {
  if (!searchTerm.trim()) {
    return messages;
  }

  return messages.filter(message =>
    message.text.toLowerCase().includes(searchTerm.toLowerCase())
  );
}, [messages, searchTerm]);

// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ä½¿ç”¨
<SearchBar
  searchTerm={searchTerm}
  onSearchChange={setSearchTerm}
/>

{filteredMessages.map((message) => (
  <MessageItem key={message.id} message={message} />
))}
```

ğŸ“ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼š**

- `useMemo` ã§ä¸è¦ãªå†è¨ˆç®—ã‚’é˜²æ­¢
- æ¤œç´¢å‡¦ç†ã®æœ€é©åŒ–

</div>
</div>

---

## 3.3 æ¤œç´¢çµæœã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ

æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤ºã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/utils/textHighlight.tsx
type HighlightTextProps = {
  text: string;
  searchTerm: string;
};

export const HighlightText = ({ text, searchTerm }: HighlightTextProps) => {
  if (!searchTerm.trim()) {
    return <>{text}</>;
  }

  const regex = new RegExp(`(${searchTerm})`, 'gi');
  const parts = text.split(regex);

  return (
    <>
      {parts.map((part, index) =>
        regex.test(part) ? (
          <Box
            key={index}
            component="span"
            sx={{
              backgroundColor: 'yellow',
              fontWeight: 'bold',
              padding: '2px 4px',
              borderRadius: '4px'
            }}
          >
            {part}
          </Box>
        ) : (
          part
        )
      )}
    </>
  );
};
```

</div>
<div>

```tsx
// MessageItem.tsx ã§ã®ä½¿ç”¨
import { HighlightText } from '../utils/textHighlight';

type MessageItemProps = {
  message: Message;
  searchTerm: string;
  onDelete: (id: number) => void;
  onEdit: (id: number, newText: string) => void;
};

// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ã‚­ã‚¹ãƒˆã®è¡¨ç¤ºéƒ¨åˆ†
<Typography variant="body1">
  <HighlightText
    text={message.text}
    searchTerm={searchTerm}
  />
</Typography>
```

ğŸ“ **ãƒã‚¤ãƒ©ã‚¤ãƒˆæ©Ÿèƒ½ï¼š**

- æ­£è¦è¡¨ç¾ã§å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„æ¤œç´¢
- é»„è‰²ã„ãƒãƒ¼ã‚«ãƒ¼ã§ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å¼·èª¿
- React Fragment ã§è‡ªç„¶ãªãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤º

</div>
</div>

---

# 4. ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šæ©Ÿèƒ½

## 4.1 è¨­å®šæ©Ÿèƒ½ã®è¿½åŠ 

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¥½ã¿ã«å¿œã˜ã¦ã‚¢ãƒ—ãƒªã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ï¼š

ğŸ“ **è¨­å®šé …ç›®ï¼š**
- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
- ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºå¤‰æ›´
- é€šçŸ¥è¨­å®š

ğŸ“ **å®Ÿè£…æ–¹é‡ï¼š**
- Material-UI ã®ãƒ†ãƒ¼ãƒã‚·ã‚¹ãƒ†ãƒ æ´»ç”¨
- localStorage ã§ã®è¨­å®šä¿å­˜
- TypeScript ã§ã®å‹å®‰å…¨ãªè¨­å®šç®¡ç†

---

## 4.2 è¨­å®šã®å‹å®šç¾©ã¨çŠ¶æ…‹ç®¡ç†

è¨­å®šæ©Ÿèƒ½ã®åŸºç›¤ã‚’ä½œæˆã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/types/settings.ts
export type AppSettings = {
  theme: 'light' | 'dark';
  fontSize: 'small' | 'medium' | 'large';
  notifications: boolean;
};

export const defaultSettings: AppSettings = {
  theme: 'light',
  fontSize: 'medium',
  notifications: true
};

// src/hooks/useSettings.ts
import { useState, useEffect } from 'react';

export const useSettings = () => {
  const [settings, setSettings] = useState<AppSettings>(defaultSettings);

  useEffect(() => {
    const saved = localStorage.getItem('chatAppSettings');
    if (saved) {
      try {
        const parsed = JSON.parse(saved) as AppSettings;
        setSettings(parsed);
      } catch (error) {
        console.error('è¨­å®šã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
      }
    }
  }, []);
```

</div>
<div>

```tsx
  const updateSettings = (newSettings: Partial<AppSettings>) => {
    const updated = { ...settings, ...newSettings };
    setSettings(updated);
    localStorage.setItem('chatAppSettings', JSON.stringify(updated));
  };

  return {
    settings,
    updateSettings
  };
};

// App.tsx ã§ã®ä½¿ç”¨
const { settings, updateSettings } = useSettings();
```

ğŸ“ **å‹å®‰å…¨æ€§ï¼š**

- è¨­å®šå€¤ã®å‹ã‚’å³å¯†ã«å®šç¾©
- `Partial<AppSettings>` ã§éƒ¨åˆ†æ›´æ–°ã‚’å‹å®‰å…¨ã«
- localStorage ã¨ã®é€£æºã‚‚å‹ãƒã‚§ãƒƒã‚¯

</div>
</div>

---

## 4.3 ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®å®Ÿè£…

Material-UI ãƒ†ãƒ¼ãƒã‚’ä½¿ã£ãŸãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/theme/theme.ts
import { createTheme } from '@mui/material/styles';

export const getTheme = (mode: 'light' | 'dark', fontSize: 'small' | 'medium' | 'large') => {
  const fontSizeMap = {
    small: 12,
    medium: 14,
    large: 16
  };

  return createTheme({
    palette: {
      mode,
      primary: {
        main: '#1976d2',
      },
      secondary: {
        main: '#dc004e',
      },
    },
    typography: {
      fontSize: fontSizeMap[fontSize],
    },
    components: {
      MuiCard: {
        styleOverrides: {
          root: {
            borderRadius: 12,
          },
        },
      },
    },
  });
};
```

</div>
<div>

```tsx
// App.tsx
import { ThemeProvider } from '@mui/material/styles';
import CssBaseline from '@mui/material/CssBaseline';

const App = () => {
  const { settings, updateSettings } = useSettings();
  const theme = getTheme(settings.theme, settings.fontSize);

  return (
    <ThemeProvider theme={theme}>
      <CssBaseline />
      <Container maxWidth="md" sx={{ py: 4 }}>
        {/* ã‚¢ãƒ—ãƒªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
      </Container>
    </ThemeProvider>
  );
};
```

ğŸ“ **ãƒ†ãƒ¼ãƒã®ç‰¹å¾´ï¼š**

- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¨ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã®è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ
- ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚‚å‹•çš„å¤‰æ›´
- Material-UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

</div>
</div>

---

## 4.4 è¨­å®šãƒ‘ãƒãƒ«ã® UI

è¨­å®šã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã® UI ã‚’ä½œæˆã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/components/SettingsPanel.tsx
import {
  Dialog, DialogTitle, DialogContent,
  FormControl, FormLabel, RadioGroup,
  FormControlLabel, Radio, Switch
} from '@mui/material';

type SettingsPanelProps = {
  open: boolean;
  onClose: () => void;
  settings: AppSettings;
  onUpdateSettings: (settings: Partial<AppSettings>) => void;
};

export const SettingsPanel = ({
  open, onClose, settings, onUpdateSettings
}: SettingsPanelProps) => {
  return (
    <Dialog open={open} onClose={onClose} maxWidth="sm" fullWidth>
      <DialogTitle>è¨­å®š</DialogTitle>
      <DialogContent>
        {/* ãƒ†ãƒ¼ãƒè¨­å®š */}
        <FormControl component="fieldset" sx={{ mb: 3 }}>
          <FormLabel component="legend">ãƒ†ãƒ¼ãƒ</FormLabel>
          <RadioGroup
            value={settings.theme}
            onChange={(e) => onUpdateSettings({ theme: e.target.value as 'light' | 'dark' })}
          >
            <FormControlLabel value="light" control={<Radio />} label="ãƒ©ã‚¤ãƒˆ" />
            <FormControlLabel value="dark" control={<Radio />} label="ãƒ€ãƒ¼ã‚¯" />
          </RadioGroup>
        </FormControl>
```

</div>
<div>

```tsx
        {/* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºè¨­å®š */}
        <FormControl component="fieldset" sx={{ mb: 3 }}>
          <FormLabel component="legend">ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º</FormLabel>
          <RadioGroup
            value={settings.fontSize}
            onChange={(e) => onUpdateSettings({ fontSize: e.target.value as any })}
          >
            <FormControlLabel value="small" control={<Radio />} label="å°" />
            <FormControlLabel value="medium" control={<Radio />} label="ä¸­" />
            <FormControlLabel value="large" control={<Radio />} label="å¤§" />
          </RadioGroup>
        </FormControl>

        {/* é€šçŸ¥è¨­å®š */}
        <FormControlLabel
          control={
            <Switch
              checked={settings.notifications}
              onChange={(e) => onUpdateSettings({ notifications: e.target.checked })}
            />
          }
          label="é€šçŸ¥ã‚’æœ‰åŠ¹ã«ã™ã‚‹"
        />
      </DialogContent>
    </Dialog>
  );
};
```

</div>
</div>

---

# 5. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

## 5.1 React.memo ã«ã‚ˆã‚‹æœ€é©åŒ–

ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’é˜²ããŸã‚ã« React.memo ã‚’æ´»ç”¨ã—ã¾ã™ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// src/components/MessageItem.tsx
import { memo } from 'react';

type MessageItemProps = {
  message: Message;
  searchTerm: string;
  onDelete: (id: number) => void;
  onEdit: (id: number, newText: string) => void;
};

export const MessageItem = memo(({
  message, searchTerm, onDelete, onEdit
}: MessageItemProps) => {
  // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…...
});

// ã‚«ã‚¹ã‚¿ãƒ æ¯”è¼ƒé–¢æ•°ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
export const MessageItem = memo(MessageItemComponent, (prevProps, nextProps) => {
  return (
    prevProps.message.id === nextProps.message.id &&
    prevProps.message.text === nextProps.message.text &&
    prevProps.message.updatedAt === nextProps.message.updatedAt &&
    prevProps.searchTerm === nextProps.searchTerm
  );
});
```

</div>
<div>

```tsx
// useCallback ã‚’ä½¿ã£ãŸé–¢æ•°ãƒ¡ãƒ¢åŒ–
const App = () => {
  const deleteMessage = useCallback(async (id: number) => {
    // å‰Šé™¤å‡¦ç†...
  }, []);

  const editMessage = useCallback(async (id: number, newText: string) => {
    // ç·¨é›†å‡¦ç†...
  }, []);

  const handleSearchChange = useCallback((term: string) => {
    setSearchTerm(term);
  }, []);

  return (
    <>
      <SearchBar
        searchTerm={searchTerm}
        onSearchChange={handleSearchChange}
      />
      {filteredMessages.map((message) => (
        <MessageItem
          key={message.id}
          message={message}
          searchTerm={searchTerm}
          onDelete={deleteMessage}
          onEdit={editMessage}
        />
      ))}
    </>
  );
};
```

</div>
</div>

---

## 5.2 ä»®æƒ³åŒ–ã«ã‚ˆã‚‹å¤§é‡ãƒ‡ãƒ¼ã‚¿å¯¾å¿œ

å¤šæ•°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’åŠ¹ç‡çš„ã«è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ä»®æƒ³åŒ–ï¼š

<div grid="~ cols-2 gap-4">
<div>

```tsx
// react-window ã‚’ä½¿ã£ãŸä»®æƒ³åŒ–ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
npm install react-window @types/react-window

// src/components/VirtualizedMessageList.tsx
import { FixedSizeList as List } from 'react-window';

type VirtualizedMessageListProps = {
  messages: Message[];
  height: number;
  itemHeight: number;
  searchTerm: string;
  onDelete: (id: number) => void;
  onEdit: (id: number, text: string) => void;
};

export const VirtualizedMessageList = ({
  messages, height, itemHeight, searchTerm, onDelete, onEdit
}: VirtualizedMessageListProps) => {
  const renderItem = ({ index, style }: any) => (
    <div style={style}>
      <MessageItem
        message={messages[index]}
        searchTerm={searchTerm}
        onDelete={onDelete}
        onEdit={onEdit}
      />
    </div>
  );
```

</div>
<div>

```tsx
  return (
    <List
      height={height}
      itemCount={messages.length}
      itemSize={itemHeight}
      itemData={messages}
    >
      {renderItem}
    </List>
  );
};

// ä½¿ç”¨ä¾‹ï¼ˆå¤§é‡ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã®ã¿ï¼‰
{filteredMessages.length > 100 ? (
  <VirtualizedMessageList
    messages={filteredMessages}
    height={400}
    itemHeight={120}
    searchTerm={searchTerm}
    onDelete={deleteMessage}
    onEdit={editMessage}
  />
) : (
  filteredMessages.map((message) => (
    <MessageItem key={message.id} {...props} />
  ))
)}
```

ğŸ“ **ä»®æƒ³åŒ–ã®åŠ¹æœï¼š**

- 1000ä»¶ä»¥ä¸Šã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã‚‚æ»‘ã‚‰ã‹ãªå‹•ä½œ
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®å‰Šæ¸›
- ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®å‘ä¸Š

</div>
</div>

---

# 6. å‹•ä½œç¢ºèªã¨ã¾ã¨ã‚

## 6.1 æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

å®Ÿè£…ã—ãŸå…¨æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ï¼š

âœ… **å‰Šé™¤æ©Ÿèƒ½ï¼š**
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å€‹åˆ¥å‰Šé™¤
- ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®å‹•ä½œ
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®å®Œå…¨å‰Šé™¤

âœ… **ç·¨é›†æ©Ÿèƒ½ï¼š**
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ã‚­ã‚¹ãƒˆã®ç·¨é›†
- ç·¨é›†æ¸ˆã¿ãƒãƒ¼ã‚¯ã®è¡¨ç¤º
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°ã®ç¢ºèª

âœ… **æ¤œç´¢æ©Ÿèƒ½ï¼š**
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œç´¢ã®å‹•ä½œ
- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„æ¤œç´¢

âœ… **è¨­å®šæ©Ÿèƒ½ï¼š**
- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
- ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºå¤‰æ›´
- è¨­å®šã®æ°¸ç¶šåŒ–

---

## 6.2 æ¬¡å›ã¸ã®æº–å‚™

æœ€çµ‚å›ã«å‘ã‘ã¦ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆï¼š

ğŸ“ **ç¢ºèªäº‹é …ï¼š**
- å…¨ã¦ã® TypeScript ã‚¨ãƒ©ãƒ¼ãŒè§£æ¶ˆã•ã‚Œã¦ã„ã‚‹
- ESLint ã®è­¦å‘ŠãŒãªã„
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒè‰¯å¥½
- ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã«å•é¡ŒãŒãªã„

ğŸ“ **æœ€çµ‚å›ã®å†…å®¹äºˆå‘Šï¼š**
- ãƒ‡ã‚¶ã‚¤ãƒ³ã®å®Œæˆåº¦å‘ä¸Š
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³
- ãƒ‡ãƒ—ãƒ­ã‚¤ã®æº–å‚™
- ç·å¾©ç¿’ã¨ã¾ã¨ã‚

---

# 7. ä»Šæ—¥ã®å®¿é¡Œ ğŸ“š

1. **ä»Šæ—¥å®Ÿè£…ã—ãŸæ©Ÿèƒ½ã‚’ã„ã‚ã„ã‚è©¦ã—ã¦ã¿ã‚‹**
   - å‰Šé™¤ãƒ»ç·¨é›†æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
   - æ¤œç´¢æ©Ÿèƒ½ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¢ã—ã¦ã¿ã‚‹
   - è¨­å®šã‚’å¤‰æ›´ã—ã¦ã¿ã‚‹

2. **React ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã«ã¤ã„ã¦èª¿ã¹ã‚‹**
   - React.memo ã®ä½¿ã„æ–¹
   - useCallback ã¨ useMemo ã®é•ã„
   - ä»®æƒ³åŒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ç¨®é¡

3. **Material-UI ã®ãƒ†ãƒ¼ãƒã‚·ã‚¹ãƒ†ãƒ ã‚’å­¦ç¿’ã™ã‚‹**
   - ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒã®ä½œæˆæ–¹æ³•
   - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰

4. **TypeScript ã®é«˜åº¦ãªå‹ã«ã¤ã„ã¦å­¦ã¶**
   - Union Types ã¨ Intersection Types
   - Conditional Types ã®åŸºæœ¬

---
layout: section
---

# ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼ ğŸ‰

## æ¬¡å›ã§ TypeScript ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªå®Œæˆã§ã™ï¼